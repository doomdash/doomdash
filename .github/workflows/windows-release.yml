name: ðŸ–¥ï¸ Windows Electron Build

on:
  # Triggers the workflow when you push a new tag (e.g., v1.0.0)
  push:
    branches:
      - 'prototype'
  # Allows manual runs from the GitHub UI
  workflow_dispatch:

jobs:
  build_windows:
    # --- 1. Use the Windows Runner ---
    runs-on: windows-latest
    
    steps:
      - name: 1. â¬‡ï¸ Checkout Repository
        uses: actions/checkout@v4

      - name: 2. âš™ï¸ Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 24 # Use a stable LTS version

      - name: 3. ðŸ“¦ Install Dependencies
        # 'npm ci' ensures a clean, consistent install in CI
        run: npm ci

      - name: 4. ðŸ”¨ Run Electron Forge 'make' for Windows
        # Since this is running on 'windows-latest', running 'npm run make'
        # will automatically target 'win32' platforms configured in your forge config.
        run: npm run make

      # --- 5. Uploading the Artifacts ---
      - name: 5. â¬†ï¸ Upload Windows Artifacts
        uses: actions/upload-artifact@v4
        with:
          name: Windows-Installer-Files
          # Electron Forge output path
          path: out/make/
          retention-days: 30
          
  # --- 6. Creating the Release ---
  # create_release:
  #   name: ðŸ“ Create GitHub Release
  #   needs: build_windows
  #   runs-on: ubuntu-latest # A fast, cheap runner for the release task
    
  #   steps:
  #     - name: 1. â¬‡ï¸ Download Windows Artifacts
  #       uses: actions/download-artifact@v4
  #       with:
  #         name: Windows-Installer-Files
  #         path: artifacts/

  #     - name: 2. ðŸ·ï¸ Get Tag Name
  #       id: get_version
  #       run: echo "TAG_NAME=${GITHUB_REF#refs/tags/}" >> $GITHUB_OUTPUT

  #     - name: 3. ðŸš€ Create GitHub Release & Attach Assets
  #       uses: softprops/action-gh-release@v2
  #       with:
  #         tag_name: ${{ steps.get_version.outputs.TAG_NAME }}
  #         draft: true # Creates a draft release for you to review first
  #         # Attach all files downloaded from the 'out/make/' folder
  #         files: artifacts/**/